<div class="row mt-2">
    <div class="col-md-8">
        <div class="card">
            <app-loading *ngIf="loading"></app-loading>
            
            
            <div class="card-body" *ngIf="!loading">
                <h4 class="card-subtitle">Listado Pedidos</h4>
                
                <table class="table table-responsive table-bordered">
                    <thead>
                        <tr>
                            <th>Turno</th>
                            <th>FechaR</th>
                            <th>FechaE</th>
                            <th>Documento:</th>
                            <th>Cliente:</th>
                            <th>BVenta:</th>
                            <th>BOrigen:</th>
                            <th>BDestino:</th>
                            <th>Estado:</th>
                            <th>Opci√≥n</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of despachos_detalle let i=index">
                            <td scope="row">{{ item['despacho_turno_nombre'] }}</td>
                            <td>{{ item['p_fecha_recibido'] | date:'YYYY-MM-dd' }}</td>
                            <td>{{ item['p_fecha_entrega'] | date:'YYYY-MM-dd' }}</td>
                            <td>{{ item['p_documento'] }}</td>
                            <td>{{ item['p_cliente'] }}</td>
                            <td>{{ item['p_almacen_venta_nombre'] }}</td>
                            <td>{{ item['p_almacen_origen_nombre'] }}</td>
                            <td>{{ item['p_almacen_destino_nombre'] }}</td>
                            <td>{{ item['p_despacho_estado_nombre'] }}</td>
                            <td>
                                <button type="button" (click)="pedido_editar(item)" class="btn btn-outline-dark btn-sm">Editar</button>
                                <button type="button" (click)="pedido_eliminar(despacho_id,item)" class="btn btn-outline-danger btn-sm">Quitar</button>
                            </td>
                        </tr>
               
                    </tbody>
                </table>
                
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card" *ngIf="!loading && operacion=='guardar'">
            <div class="card-body" >
                <h4 class="card-subtitle">Registro Pedido</h4>
    
                <form class="cmxform mt-2" (ngSubmit)="agregar_pedido()" [formGroup]="formPedido" >
                    <fieldset>
                    
                        <div class="row">

                            <div class="col-lg-12">
                                <div class="form-group">
                                    <label>Pedido:</label>
                                    <select formControlName="despacho_pedido_id" 
                                            class="form-control">
                                        <option value="" selected>Seleccionar</option>
                                        <option value="{{ pedido['id']}}" *ngFor="let pedido of pedidos">{{ pedido['fecha_recibido'] }} - {{ pedido['documento'] }} - {{ pedido['cliente'] }}</option>
                                    </select>
                                    <label class="error mt-2 text-danger" 
                                            for="despacho_pedido_id" 
                                            *ngIf="campoNoValido('despacho_pedido_id')">*Escoja pedido </label>
                                </div>
                            </div>

                            <div class="col-lg-12">
                                <div class="form-group">
                                    <label>Turno:</label>
                                    <select formControlName="despacho_turno_id" 
                                            class="form-control">
                                        <option value="" selected>Seleccionar</option>
                                        <option value="{{ turno['id']}}" *ngFor="let turno of turnos">{{ turno['nombre'] }}</option>
                                    </select>
                                    <label class="error mt-2 text-danger" 
                                            for="despacho_turno_id" 
                                            *ngIf="campoNoValido('despacho_turno_id')">*Escoja turno </label>
                                </div>
                            </div>

                            <div class="col-lg-12">
                                <div class="form-group">
                                    <label>Documentos:</label>
                                    <input type="text" 
                                        formControlName="documentos_entrega"
                                        class="form-control"
                                        placeholder="Digite documentos entrega" />
                                    <label class="error mt-2 text-danger" 
                                            for="documentos_entrega" 
                                            *ngIf="campoNoValido('documentos_entrega')">*Digite documentos</label>
                                </div>
                            </div>
                        
                        </div>
                    
                        <button type="submit" class="btn btn-outline-primary">Agregar</button>
                    </fieldset>
                </form>

                <div class="row mt-2" *ngIf="errors.length>0">
                    <div class="col-12">
                        <div class="alert alert-danger " role="alert">
                            <ul>
                                <li *ngFor="let error of errors" >{{ error }}</li>
                            </ul>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <app-despacho-admin-detalle-update
                *ngIf="!loading && operacion=='editar'" 
                [despachos_arr]="despachos_detalle" 
                [despacho_detalle_id]="despacho_detalle_id" 
                [despacho_id]="despacho_id" 
                [pedido_id]="pedido_id" 
                (despacho_form)="depachos_detalle = $event" 
                (operacion_editar)="operacion = $event">
        </app-despacho-admin-detalle-update>

    </div>
</div>
